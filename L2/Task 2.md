МОНИТОРИНГ ПРОЦЕССОВ

Лабораторная работа №2

Задача

• Необходимо написать приложение (скрипт/сервис/ модуль

ядра), осуществляющее слежение за исполняемыми

процессами.

• Приложение должно иметь конфигурационный файл, в

котором перечислены имена (пути) к исполняемым файлам.

• Все эти исполняемые файлы считаются **запрещенными**.

• Как только запускается запрещенный процесс, приложение

должно его завершить.

• Поскольку запрещенные процессы могут работать с правами

администратора, необходимо, чтобы приложение само

запрашивало права администратора при запуске

Пример

• Конфигурационный файл

• {

• "blacklistedapps" : [

• "C:\\Windows\\System32\\calc.exe",

• "C:\\Windows\\System32\\notepad.exe",

• "C:\\Windows\\System32\\mspaint.exe"

• ]

• }

Дополнительные задания - 1

• Лог для приложения

• Приложение должно вести свой лог

• Приложение должно записывать туда время создания всех процессов в

системе

• Если был найден запрещенный процесс, логгировать попытку и

результат его завершения.

Дополнительные задания - 1

• Пример лога

• 2021-09-27 12:10:56 C:\Program Files\Google\Chrome\Application\chrome.exe [pid 8592]

• 2021-09-27 12:11:02 C:\Windows\System32\explorer.exe [pid 2974]

• 2021-09-27 12:11:04 C:\Program Files\Internet Explorer\iexplore.exe [pid 9787]

• 2021-09-27 12:12:12 C:\Windows\System32\notepad.exe [pid 2760]

• 2021-09-27 12:12:13 [BANNED APP] - C:\Windows\System32\notepad.exe [pid 2760] - killing...

• 2021-09-27 12:12:13 [BANNED APP] - pid 2760 wasn't killed - error '5' (ERROR\_ACCESS\_DENIED)

• 2021-09-27 12:12:23 C:\Program Files\Google\Chrome\Application\chrome.exe [pid 964]

• 2021-09-27 12:13:00 C:\Windows\System32\calc.exe [pid 7789]

• 2021-09-27 12:13:01 [BANNED APP] - C:\Windows\System32\calc.exe [pid 7789] - killing...

• 2021-09-27 12:13:01 [BANNED APP] - successfully killed pid 7789 - error '0' (ERROR\_SUCCESS)

Дополнительные задания - 2

• Графический интерфейс для главного приложения

• Графический интерфейс должен отображать список запрещенных

приложений и позволять его модифицировать

• Графический интерфейс должен показывать лог (если он ведется)

• Графический интерфейс должен запрашивать права

администратора один раз при запуске (не при каждой попытке

завершить запрещенный процесс)

Дополнительные задания - 3

• Конфигурация запрещенных приложений по их хешу

• Поскольку пути к одному приложению могут быть разными на разных

компьютерах, то целесообразнее проверять приложения по их хешу.

• C:\Program Files\Office\word.exe или C:\Program Files (x86)\Office\word.exe;

• Вместо хеша может быть другая проверка - проверка цифровой подписи,

проверка дополнительных параметров файла - даты, времени, версии и тд.

• Хеш-алгоритм может быть любым

Дополнительные задания - 4

• Вычисление среднего потребления CPU и RAM для процессов

• Помимо списка запрещенных процессов, должен быть список

отслеживаемых процессов

• Список может быть в том же или в отдельном конфигурационном файле

• Приложения из списка отслеживаемых процессов не должны

завершаться при запуске

• Для каждого такого процесса, при его старте должен запускаться

монитор производительности

• При завершении процесса нужно сохранить данные о среднем

потреблении CPU и RAM

Дополнительные задания - 4

• Пример лога с performance-информацией

• 2021-09-27 12:10:56 C:\Program Files\Google\Chrome\Application\chrome.exe [pid 8592]

• 2021-09-27 12:11:02 C:\Windows\System32\explorer.exe [pid 2974]

• 2021-09-27 12:11:04 C:\Program Files\Internet Explorer\iexplore.exe [pid 9787]

• 2021-09-27 12:12:12 C:\Windows\System32\notepad.exe [pid 2760]

• 2021-09-27 12:12:13 [BANNED APP] - C:\Windows\System32\notepad.exe [pid 2760] - killing...

• 2021-09-27 12:12:13 [BANNED APP] - pid 2760 wasn't killed - error '5' (ERROR\_ACCESS\_DENIED)

• 2021-09-27 12:12:23 C:\Program Files\Google\Chrome\Application\chrome.exe [pid 964]

• 2021-09-27 12:12:53 [STATS] chrome.exe [pid 964] worked for 30 seconds, measured 301 times

• 2021-09-27 12:12:53 [STATS] chrome.exe [pid 964] avg CPU=15%, avg RAM=320MB

Требования

• Операционная система – Windows, Linux, macOS.

• Если есть желание использовать другую систему – нужно предварительно обсудить

• Язык программирования – без ограничений.

Оценивание

• 3 балла за основное задание

• Приложение работает с правами администратора

• Приложение следит за новыми процессами в системе

• Приложение закрывает запрещенные процессы

• 3 балла за выполнение работы вовремя

• До 8 ноября

• 1 балл за ведение лога приложения

• 1 балл за отслеживание ресурсов для отдельного списка процессов

• 1 балл за проверку приложений не по пути (хеш/подпись/…)

• 1 балл за реализацию графического интерфейса у главного приложения
